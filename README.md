# ç½å¤´æ—¥è®° (Canned Diary)

ä¸€æ¬¾é¢å‘ä¸­å°å­¦ç”Ÿçš„ AI é™ªä¼´å†™ä½œåº”ç”¨ã€‚

åŸºäº **MCP å…¼å®¹çš„ Tool-Augmented Agent** æ¶æ„ï¼Œæˆ‘ä»¬è®© AI ä¸åªæ˜¯"èƒ½èŠå¤©"ï¼Œè€Œæ˜¯çœŸæ­£"èƒ½è®°ä½ã€èƒ½æ€è€ƒã€èƒ½è¡ŒåŠ¨"ã€‚

## æ ¸å¿ƒæŠ€æœ¯äº®ç‚¹

| ç‰¹æ€§ | è¯´æ˜ |
|------|------|
| ğŸ”§ **MCP å·¥å…·åè®®** | 6 å¤§å·¥å…·æ¨¡å—ï¼ˆè®°å¿†/æ—¥è®°/çŸ¥è¯†/æ¨ç†ï¼‰ï¼Œå³æ’å³ç”¨ï¼Œå¯æ‰©å±• |
| ğŸ§  **é•¿æœŸè®°å¿†ç³»ç»Ÿ** | æŒä¹…åŒ–ç”¨æˆ·ç”»åƒï¼Œè·¨ä¼šè¯ä¸ªæ€§åŒ–ï¼Œè¶ŠèŠè¶Šæ‡‚ä½  |
| ğŸ¤– **å¤š Agent ååŒ** | Chat / Diary / Surprise ä¸‰å¤§ä¸“å®¶ Agentï¼Œå„å¸å…¶èŒ |
| ğŸ“ **ç»“æ„åŒ–è¾“å‡º** | JSON Schema å¼ºçº¦æŸï¼Œ100% å¯è§£æï¼Œç±»å‹å®‰å…¨ |
| âš¡ **æµå¼å·¥å…·æ‰§è¡Œ** | å®æ—¶æ¨ç†è¿‡ç¨‹å¯è§ï¼Œå¤šæ­¥å·¥å…·é“¾ï¼Œ< 500ms é¦–å­—å“åº” |
| ğŸ”Œ **æ¨¡å‹æ— å…³è®¾è®¡** | LLM Gateway æŠ½è±¡ï¼Œæ”¯æŒä¸»æµå¤§æ¨¡å‹ä¸€é”®åˆ‡æ¢ |

## äº§å“ç‰¹æ€§

- **æ™ºèƒ½æ—¥è®°åé¦ˆ** - AI æ ¹æ®æ—¥è®°å†…å®¹ç”Ÿæˆä¸ªæ€§åŒ–å›ä¿¡ï¼Œç»™äºˆæƒ…æ„Ÿå›åº”å’Œå†™ä½œå»ºè®®
- **åˆ†çº§ç´ æåº“** - 5 å¤§åˆ†ç±»ç´ æï¼ˆæ–‡å­¦å¸¸è¯†ã€è¯—è¯æˆè¯­ã€åäººåè¨€ã€çƒ­ç‚¹æ—¶äº‹ã€äººæ–‡ç™¾ç§‘ï¼‰ï¼ŒæŒ‰å¹´çº§åˆ†å±‚
- **AI å¯¹è¯åŠ©æ‰‹** - ä¸"å°ç½ç½"å®æ—¶å¯¹è¯ï¼Œæ”¯æŒæœç´¢æ—¥è®°ã€æŸ¥è¯¢ç´ æã€è§£ç­”ç–‘é—®
- **æƒŠå–œç½å¤´** - æœªå†™æ—¥è®°çš„æ—¥æœŸå¯æ‰“å¼€æƒŠå–œï¼Œè·å–å†™ä½œæŒ‘æˆ˜æˆ–çŸ¥è¯†è¶£å‘³å†…å®¹
- **è¿ç»­æ‰“å¡** - è®°å½•è¿ç»­å†™æ—¥è®°å¤©æ•°ï¼ŒåŸ¹å…»å†™ä½œä¹ æƒ¯

## æŠ€æœ¯æ¶æ„

### Tool-Augmented Agent

```
ç”¨æˆ·è¾“å…¥ â†’ Agent æ€è€ƒ â†’ é€‰æ‹©å·¥å…· â†’ æ‰§è¡ŒåŠ¨ä½œ â†’ æ•´åˆç»“æœ â†’ ç”Ÿæˆå›å¤
```

Agent å¯åœ¨å•è½®å¯¹è¯ä¸­è¿›è¡Œå¤šæ­¥æ¨ç†ï¼ˆMulti-step Reasoningï¼‰ï¼Œè‡ªä¸»å†³å®šä½•æ—¶è°ƒç”¨å“ªä¸ªå·¥å…·ï¼Œå®ç° **ReAct (Reasoning + Acting)** èŒƒå¼ã€‚

### MCP å…¼å®¹å·¥å…·é“¾

é‡‡ç”¨æ ‡å‡†åŒ–çš„ Tool Schema å®šä¹‰ï¼ŒAgent å¯åŠ¨æ€å‘ç°å’Œè°ƒç”¨å·¥å…·ï¼š

| å·¥å…·ç±»å‹ | å·¥å…·åç§° | åŠŸèƒ½ |
|---------|---------|------|
| ğŸ§  Memory Tools | `saveMemory` | ä¿å­˜ç”¨æˆ·åå¥½ã€ä¹ æƒ¯ã€äº‹ä»¶ã€æƒ…ç»ª |
| ğŸ§  Memory Tools | `getMemories` | æ£€ç´¢å†å²è®°å¿†ï¼Œä¸ªæ€§åŒ–å›å¤ |
| ğŸ“– Diary Tools | `searchDiaries` | æœç´¢å†å²æ—¥è®° |
| ğŸ“– Diary Tools | `getDiaryDetail` | è·å–æ—¥è®°è¯¦æƒ… |
| ğŸ“š Knowledge Tools | `getMaterial` | è·å–è¯—è¯ã€åè¨€ã€ç™¾ç§‘ç´ æ |
| ğŸ’¡ Reasoning Tools | `explainConcept` | è¶£å‘³è®²è§£çŸ¥è¯†æ¦‚å¿µ |

### å¤š Agent ååŒ

| Agent | èŒè´£ | å·¥å…·æƒé™ |
|-------|------|---------|
| ğŸ’¬ Chat Agent | å®æ—¶å¯¹è¯é™ªä¼´ | Memory + Knowledge + Diary |
| ğŸ“ Diary Agent | æ—¥è®°åˆ†æåé¦ˆ | Semantic Matching + Material Retrieval |
| ğŸ Surprise Agent | åˆ›æ„å†…å®¹ç”Ÿæˆ | Knowledge + Creative Prompt |

### é•¿æœŸè®°å¿†ç³»ç»Ÿ

çªç ´ä¼ ç»Ÿ AI"é‡‘é±¼è®°å¿†"é™åˆ¶ï¼Œå®ç° Persistent Memory Layerï¼š

| è®°å¿†ç±»å‹ | è¯´æ˜ | ç¤ºä¾‹ |
|---------|------|------|
| Preference | ç”¨æˆ·åå¥½ç”»åƒ | å–œæ¬¢æé¾™ã€è®¨åŒé’æ¤’ |
| Habit | è¡Œä¸ºä¹ æƒ¯æ¨¡å¼ | æ¯å¤©æ”¾å­¦åå†™æ—¥è®° |
| Event | é‡è¦äº‹ä»¶æ—¶é—´çº¿ | ä¸Šå‘¨å‚åŠ äº†è¿åŠ¨ä¼š |
| Emotion | æƒ…ç»ªçŠ¶æ€è¿½è¸ª | æœ€è¿‘å› è€ƒè¯•æœ‰ç‚¹ç„¦è™‘ |

### åˆ†çº§è‡ªé€‚åº”ç³»ç»Ÿ

æ ¹æ®ç”¨æˆ·å¹´çº§åŠ¨æ€è°ƒæ•´ AI äººæ ¼ã€è¯­è¨€é£æ ¼ã€çŸ¥è¯†æ·±åº¦ï¼š

- **ä½å¹´çº§ (1-3å¹´çº§)** - æ´»æ³¼å¯çˆ±ï¼Œç®€å•è¯æ±‡ï¼Œå¤šç”¨å è¯æ‹Ÿå£°è¯
- **ä¸­å¹´çº§ (4-6å¹´çº§)** - æ¸©æš–æ™ºæ…§ï¼Œæˆè¯­ä¿®è¾ï¼ŒåƒçŸ¥å¿ƒæœ‹å‹
- **é«˜å¹´çº§ (åˆä¸­)** - å¹³ç­‰æ·±åˆ»ï¼Œæ–‡å­¦å“²ç†ï¼Œå¯å‘æ€è€ƒ

## æŠ€æœ¯æ ˆ

### å‰ç«¯
- React 19 + TypeScript
- Vite æ„å»ºå·¥å…·
- React Router v7 è·¯ç”±
- Vercel AI SDK é›†æˆ
- IndexedDB æœ¬åœ°å­˜å‚¨

### åç«¯
- Node.js + Express
- LLM Gateway (LiteLLM)
- Vercel AI SDK (streamText + tool)
- Zod Schema éªŒè¯
- JSON Schema ç»“æ„åŒ–è¾“å‡º

## å¿«é€Ÿå¼€å§‹

### ç¯å¢ƒè¦æ±‚
- Node.js >= 18
- pnpm åŒ…ç®¡ç†å™¨

### å®‰è£…ä¾èµ–

```bash
# å‰ç«¯ä¾èµ–
pnpm install

# åç«¯ä¾èµ–
cd server && pnpm install
```

### é…ç½®ç¯å¢ƒå˜é‡

åˆ›å»º `.env` æ–‡ä»¶ï¼š

```env
VITE_LITELLM_API_KEY=your_api_key
VITE_LITELLM_PROXY_URL=your_proxy_url
VITE_API_URL=http://localhost:3001
```

### å¯åŠ¨å¼€å‘æœåŠ¡å™¨

```bash
# å¯åŠ¨å‰ç«¯ï¼ˆç«¯å£ 3000ï¼‰
pnpm dev

# å¯åŠ¨åç«¯ï¼ˆç«¯å£ 3001ï¼‰
cd server && pnpm start
```

è®¿é—® http://localhost:3000 å³å¯ä½¿ç”¨ã€‚

## é¡¹ç›®ç»“æ„

```
child/
â”œâ”€â”€ src/                    # å‰ç«¯æºä»£ç 
â”‚   â”œâ”€â”€ pages/             # é¡µé¢ç»„ä»¶
â”‚   â”œâ”€â”€ components/        # UI ç»„ä»¶
â”‚   â”œâ”€â”€ services/          # ä¸šåŠ¡æœåŠ¡
â”‚   â”œâ”€â”€ contexts/          # React Context
â”‚   â”œâ”€â”€ hooks/             # è‡ªå®šä¹‰ Hooks
â”‚   â””â”€â”€ types.ts           # ç±»å‹å®šä¹‰
â”œâ”€â”€ server/                 # åç«¯æœåŠ¡
â”‚   â””â”€â”€ src/
â”‚       â”œâ”€â”€ index.js       # Express å…¥å£
â”‚       â”œâ”€â”€ config/        # é…ç½®æ¨¡å—
â”‚       â”‚   â”œâ”€â”€ prompts.js # æç¤ºè¯é…ç½®ï¼ˆAgent System Promptï¼‰
â”‚       â”‚   â””â”€â”€ constants.js # å¸¸é‡å®šä¹‰
â”‚       â”œâ”€â”€ routes/        # API è·¯ç”±
â”‚       â”‚   â”œâ”€â”€ materials.js  # ç´ ææ¥å£
â”‚       â”‚   â”œâ”€â”€ checkin.js    # ç­¾åˆ°æ¥å£
â”‚       â”‚   â”œâ”€â”€ diary.js      # Diary Agent
â”‚       â”‚   â”œâ”€â”€ surprise.js   # Surprise Agent
â”‚       â”‚   â”œâ”€â”€ chat.js       # Chat Agent + Tools
â”‚       â”‚   â””â”€â”€ health.js     # å¥åº·æ£€æŸ¥
â”‚       â”œâ”€â”€ services/      # ä¸šåŠ¡æœåŠ¡
â”‚       â”‚   â”œâ”€â”€ llm.js     # LLM Gateway
â”‚       â”‚   â””â”€â”€ cache.js   # ç¼“å­˜æœåŠ¡
â”‚       â””â”€â”€ utils/         # å·¥å…·å‡½æ•°
â”‚           â””â”€â”€ parseJSON.js # JSON è§£æ
â”œâ”€â”€ data/                   # é™æ€ç´ ææ•°æ®
â”‚   â””â”€â”€ materials/         # åˆ†çº§ç´ æ JSON
â””â”€â”€ doc/                    # é¡¹ç›®æ–‡æ¡£
    â”œâ”€â”€ product.md         # äº§å“æ–‡æ¡£
    â””â”€â”€ technical.md       # æŠ€æœ¯æ–‡æ¡£
```

## æ–‡æ¡£

- [äº§å“æ–‡æ¡£](./doc/product.md) - åŠŸèƒ½ä»‹ç»ã€ç”¨æˆ·æŒ‡å—
- [æŠ€æœ¯æ–‡æ¡£](./doc/technical.md) - æ¶æ„è®¾è®¡ã€API æ¥å£ã€å¼€å‘æŒ‡å—

## è®¸å¯è¯

ç§æœ‰é¡¹ç›®ï¼Œä¿ç•™æ‰€æœ‰æƒåˆ©ã€‚
